import unittest
from src.kernelpop import potentially_vulnerable
from src.kernelpop import Kernel
from exploits.linux.CVE20091185 import CVE20091185


class TestGetKernelVersion(unittest.TestCase):

	def test_find_linux_exploit(self):
		test_uname = "Linux-4.10.0-37-generic-x86_64-with-Ubuntu-16.04-xenial"
		test_kernel = Kernel(test_uname)
		exploit_module = CVE20091185()
		self.assertTrue(potentially_vulnerable(test_kernel, exploit_module))